# Cloudflare Tunnel ingresses for external monitoring services
# With Homepage auto-discovery annotations
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: grafana-cloudflare
  namespace: apps
  annotations:
    # Disabled - configured manually in services.yaml with kubernetes status
    gethomepage.dev/enabled: "false"
spec:
  ingressClassName: cloudflare-tunnel
  rules:
    - host: grafana.kernow.io
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: grafana-external
                port:
                  number: 80
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: prometheus-cloudflare
  namespace: apps
  annotations:
    # Disabled - configured manually in services.yaml with kubernetes status
    gethomepage.dev/enabled: "false"
spec:
  ingressClassName: cloudflare-tunnel
  rules:
    - host: prometheus.kernow.io
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: prometheus-external
                port:
                  number: 80
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: victoriametrics-cloudflare
  namespace: apps
  annotations:
    # Disabled - configured manually in services.yaml with kubernetes status
    gethomepage.dev/enabled: "false"
spec:
  ingressClassName: cloudflare-tunnel
  rules:
    - host: victoria-metrics.kernow.io
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: victoriametrics-external
                port:
                  number: 80
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: victorialogs-cloudflare
  namespace: apps
  annotations:
    # Disabled - configured manually in services.yaml with kubernetes status
    gethomepage.dev/enabled: "false"
spec:
  ingressClassName: cloudflare-tunnel
  rules:
    - host: victoria-logs.kernow.io
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: victorialogs-external
                port:
                  number: 80
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: alertmanager-cloudflare
  namespace: apps
  annotations:
    # Disabled - configured manually in services.yaml with kubernetes status
    gethomepage.dev/enabled: "false"
spec:
  ingressClassName: cloudflare-tunnel
  rules:
    - host: alertmanager.kernow.io
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: alertmanager-external
                port:
                  number: 80
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: gatus-cloudflare
  namespace: apps
  annotations:
    # Disabled - configured manually in services.yaml with kubernetes status
    gethomepage.dev/enabled: "false"
spec:
  ingressClassName: cloudflare-tunnel
  rules:
    - host: gatus.kernow.io
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: gatus-external
                port:
                  number: 80
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: beszel-cloudflare
  namespace: apps
  annotations:
    # Disabled - widget configured directly in services.yaml for env var substitution
    gethomepage.dev/enabled: "false"
spec:
  ingressClassName: cloudflare-tunnel
  rules:
    - host: beszel.kernow.io
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: beszel-external
                port:
                  number: 80
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: coroot-cloudflare
  namespace: apps
  annotations:
    # Disabled - configured manually in services.yaml with kubernetes status
    gethomepage.dev/enabled: "false"
spec:
  ingressClassName: cloudflare-tunnel
  rules:
    - host: coroot.kernow.io
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: coroot-external
                port:
                  number: 80
---
# PBS Backup Server on Pihanga
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: pbs-cloudflare
  namespace: apps
  annotations:
    gethomepage.dev/enabled: "false"
    nginx.ingress.kubernetes.io/backend-protocol: "HTTPS"
spec:
  ingressClassName: cloudflare-tunnel
  rules:
    - host: pbs.kernow.io
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: pbs-external
                port:
                  number: 443
---
# Pihanga Proxmox
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: proxmox-pihanga-cloudflare
  namespace: apps
  annotations:
    gethomepage.dev/enabled: "false"
    nginx.ingress.kubernetes.io/backend-protocol: "HTTPS"
spec:
  ingressClassName: cloudflare-tunnel
  rules:
    - host: proxmox.pihanga.kernow.io
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: proxmox-pihanga-external
                port:
                  number: 443
---
# Proxmox Datacenter Manager
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: pdm-cloudflare
  namespace: apps
  annotations:
    gethomepage.dev/enabled: "false"
    nginx.ingress.kubernetes.io/backend-protocol: "HTTPS"
spec:
  ingressClassName: cloudflare-tunnel
  rules:
    - host: pdm.kernow.io
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: pdm-external
                port:
                  number: 443
