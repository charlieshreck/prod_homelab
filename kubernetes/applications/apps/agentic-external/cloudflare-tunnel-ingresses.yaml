# Cloudflare Tunnel ingresses for agentic cluster services
# With Homepage auto-discovery annotations
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: matrix-cloudflare
  namespace: apps
  annotations:
    # Disabled - configured manually in services.yaml with kubernetes status
    gethomepage.dev/enabled: "false"
spec:
  ingressClassName: cloudflare-tunnel
  rules:
    - host: matrix.kernow.io
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: matrix-external
                port:
                  number: 80
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: langgraph-cloudflare
  namespace: apps
  annotations:
    # Disabled - configured manually in services.yaml with kubernetes status
    gethomepage.dev/enabled: "false"
spec:
  ingressClassName: cloudflare-tunnel
  rules:
    - host: langgraph.kernow.io
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: langgraph-external
                port:
                  number: 80
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: vikunja-cloudflare
  namespace: apps
  annotations:
    # Disabled - configured manually in services.yaml with kubernetes status
    gethomepage.dev/enabled: "false"
spec:
  ingressClassName: cloudflare-tunnel
  rules:
    - host: vikunja.kernow.io
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: vikunja-external
                port:
                  number: 80
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: mcp-webhook-cloudflare
  namespace: apps
  annotations:
    gethomepage.dev/enabled: "false"
spec:
  ingressClassName: cloudflare-tunnel
  rules:
    - host: mcp-webhook.kernow.io
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: mcp-config-sync-external
                port:
                  number: 80
---
# Outline wiki - nginx sidecar in agentic cluster handles robots.txt
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: outline-cloudflare
  namespace: apps
  annotations:
    # Disabled - configured manually in services.yaml with kubernetes status
    gethomepage.dev/enabled: "false"
spec:
  ingressClassName: cloudflare-tunnel
  rules:
    - host: outline.kernow.io
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: outline-external
                port:
                  number: 80
---
# Backrest backup management - with widget
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: backrest-cloudflare
  namespace: apps
  annotations:
    # Disabled - configured manually in services.yaml with kubernetes status
    gethomepage.dev/enabled: "false"
spec:
  ingressClassName: cloudflare-tunnel
  rules:
    - host: backrest.kernow.io
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: backrest-external
                port:
                  number: 80
---
# Garage S3 storage web UI
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: garage-cloudflare
  namespace: apps
  annotations:
    # Disabled - configured manually in services.yaml with kubernetes status
    gethomepage.dev/enabled: "false"
spec:
  ingressClassName: cloudflare-tunnel
  rules:
    - host: garage.kernow.io
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: garage-external
                port:
                  number: 80
---
# Silver Bullet markdown PKM
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: silverbullet-cloudflare
  namespace: apps
  annotations:
    # Disabled - configured manually in services.yaml with kubernetes status
    gethomepage.dev/enabled: "false"
spec:
  ingressClassName: cloudflare-tunnel
  rules:
    - host: silverbullet.kernow.io
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: silverbullet-external
                port:
                  number: 80
---
# Kernow Hub unified PWA (app has built-in auth)
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: kernow-hub-cloudflare
  namespace: apps
  annotations:
    gethomepage.dev/enabled: "false"
spec:
  ingressClassName: cloudflare-tunnel
  rules:
    - host: kernow.kernow.io
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: kernow-hub-external
                port:
                  number: 80
---
# Tamar PWA (app has built-in auth + Cloudflare Access recommended)
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: tamar-cloudflare
  namespace: apps
  annotations:
    gethomepage.dev/enabled: "false"
spec:
  ingressClassName: cloudflare-tunnel
  rules:
    - host: tamar.kernow.io
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: tamar-external
                port:
                  number: 80
