# Cloudflare Tunnel ingresses for agentic cluster services
# With Homepage auto-discovery annotations
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: matrix-cloudflare
  namespace: apps
  annotations:
    gethomepage.dev/enabled: "true"
    gethomepage.dev/name: "Matrix"
    gethomepage.dev/group: "Agentic"
    gethomepage.dev/icon: "matrix.png"
    gethomepage.dev/description: "Matrix/Conduit Server"
    gethomepage.dev/pod-selector: ""
spec:
  ingressClassName: cloudflare-tunnel
  rules:
    - host: matrix.kernow.io
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: matrix-external
                port:
                  number: 80
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: langgraph-cloudflare
  namespace: apps
  annotations:
    gethomepage.dev/enabled: "true"
    gethomepage.dev/name: "LangGraph"
    gethomepage.dev/group: "Agentic"
    gethomepage.dev/icon: "mdi-graph"
    gethomepage.dev/description: "AI Orchestration"
    gethomepage.dev/pod-selector: ""
spec:
  ingressClassName: cloudflare-tunnel
  rules:
    - host: langgraph.kernow.io
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: langgraph-external
                port:
                  number: 80
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: vikunja-cloudflare
  namespace: apps
  annotations:
    gethomepage.dev/enabled: "true"
    gethomepage.dev/name: "Vikunja"
    gethomepage.dev/group: "Agentic"
    gethomepage.dev/icon: "vikunja"
    gethomepage.dev/description: "Task & Project Management"
    gethomepage.dev/pod-selector: ""
spec:
  ingressClassName: cloudflare-tunnel
  rules:
    - host: vikunja.kernow.io
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: vikunja-external
                port:
                  number: 80
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: claude-refresh-cloudflare
  namespace: apps
  annotations:
    gethomepage.dev/enabled: "true"
    gethomepage.dev/name: "Claude Refresh"
    gethomepage.dev/group: "Agentic"
    gethomepage.dev/icon: "mdi-key-change"
    gethomepage.dev/description: "Claude OAuth Token Refresh"
    gethomepage.dev/pod-selector: ""
spec:
  ingressClassName: cloudflare-tunnel
  rules:
    - host: claude-refresh.kernow.io
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: claude-refresh-external
                port:
                  number: 80
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: mcp-webhook-cloudflare
  namespace: apps
  annotations:
    gethomepage.dev/enabled: "false"
spec:
  ingressClassName: cloudflare-tunnel
  rules:
    - host: mcp-webhook.kernow.io
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: mcp-config-sync-external
                port:
                  number: 80
---
# Outline wiki - nginx sidecar in agentic cluster handles robots.txt
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: outline-cloudflare
  namespace: apps
  annotations:
    gethomepage.dev/enabled: "true"
    gethomepage.dev/name: "Outline"
    gethomepage.dev/group: "Agentic"
    gethomepage.dev/icon: "outline.png"
    gethomepage.dev/description: "Wiki & Knowledge Base"
    gethomepage.dev/pod-selector: ""
spec:
  ingressClassName: cloudflare-tunnel
  rules:
    - host: outline.kernow.io
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: outline-external
                port:
                  number: 80
---
# Backrest backup management
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: backrest-cloudflare
  namespace: apps
  annotations:
    gethomepage.dev/enabled: "true"
    gethomepage.dev/name: "Backrest"
    gethomepage.dev/group: "Infrastructure"
    gethomepage.dev/icon: "mdi-backup-restore"
    gethomepage.dev/description: "Backup Management (restic)"
    gethomepage.dev/pod-selector: ""
spec:
  ingressClassName: cloudflare-tunnel
  rules:
    - host: backrest.kernow.io
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: backrest-external
                port:
                  number: 80
---
# Garage S3 storage web UI
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: garage-cloudflare
  namespace: apps
  annotations:
    gethomepage.dev/enabled: "true"
    gethomepage.dev/name: "Garage"
    gethomepage.dev/group: "Infrastructure"
    gethomepage.dev/icon: "mdi-garage"
    gethomepage.dev/description: "S3-Compatible Storage"
    gethomepage.dev/pod-selector: ""
spec:
  ingressClassName: cloudflare-tunnel
  rules:
    - host: garage.kernow.io
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: garage-external
                port:
                  number: 80
---
# Silver Bullet markdown PKM
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: silverbullet-cloudflare
  namespace: apps
  annotations:
    gethomepage.dev/enabled: "true"
    gethomepage.dev/name: "Silver Bullet"
    gethomepage.dev/group: "Agentic"
    gethomepage.dev/icon: "silverbullet.png"
    gethomepage.dev/description: "Markdown PKM"
    gethomepage.dev/pod-selector: ""
spec:
  ingressClassName: cloudflare-tunnel
  rules:
    - host: silverbullet.kernow.io
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: silverbullet-external
                port:
                  number: 80
